<!-- CONTAINER FLUID -->
<div data-ng-controller="_mycloud_mydevices" class="container-fluid">
    <!--HEADING - REGISTRAR NUEVO DISPOSITIVO-->
    <div class="row" data-ng-if="SelectedDevice === undefined">
        <div class="col-sm-12">
            <button class="btn btn-primary" style="float:right; margin:10px 0" title="Registrar nuevo dispositivo" data-ng-click="NewDevicesMode()"><i class="glyphicon glyphicon-plus"></i> Nuevo Dispositivo</button>
            <br><br><br>
            <div data-ng-show="AddingDevice" class="pull-right panel panel-info" style="width:100%; padding: 10px">
                <div class="panel-heading">
                    Nuevo Dispositivo:
                    <i class="glyphicon glyphicon-remove pull-right pvcloud-device-edit"  title="Cancelar Edición" data-ng-click="CancelNewDevicesMode()"></i>
                </div>                
                <div class="panel-body success">

                    <div class="pvcloud-edit-toolbar panel panel-default pull-right">
                        <div class="panel-content">
                            <i class="glyphicon glyphicon-floppy-save pvcloud-device-edit pull-right" style="color:green" data-ng-click="AddDevice_Save()"  title="Guardar Cambios"></i>&nbsp;
                        </div>
                    </div>     


                    <table style="width:60%" class="pvcloud-device-edit-form">
                        <tr>
                            <td style="text-align: right">Nombre:</td>
                            <td><input data-ng-model="AddDevice_device_nickname" type="text" style="width:100%" /></td>
                        </tr>
                        <tr>
                            <td style="text-align: right">Descripción:</td>
                            <td>
                                <textarea data-ng-model="AddDevice_device_description" style="width:100%" rows="2"></textarea>

                        </tr>
                    </table>  
                </div>
            </div>
        </div>
    </div>
    <!--LISTA DE DISPOSITIVOS-->
    <table class="table table-striped table-hover" data-ng-if="Devices && Devices.length > 0 && SelectedDevice === undefined">
        <tr>
            <th>ID</th>
            <th>Nombre de Dipositivo</th>
            <th style="text-align: center">API KEY</th>
            <th></th>
        </tr>
        <tr id="tr_device_{{device.device_id}}" data-ng-repeat="device in Devices">
            <td class="td-device-info" style="vertical-align: middle">{{device.device_id}}</td>
            <td class="td-device-info" colspan="{{device.deviceBeingEdited?3:1}}">
                <i class="glyphicon glyphicon-remove pull-right pvcloud-device-edit" data-ng-show="device.deviceBeingEdited" data-ng-click="EditDevice_Cancel(device)" title="Cancelar Edición"></i>
                <div class="pvcloud-edit-toolbar panel panel-default pull-right" data-ng-show="device.deviceBeingEdited">
                    <div class="panel-content">
                        <i class="glyphicon glyphicon-refresh pvcloud-device-edit" style="color:orange" data-ng-click="EditDevice_NewAPIKey(device)" title="Haga clic para generar un nuevo API KEY"  style="color:maroon"></i>&nbsp;
                        <i class="glyphicon glyphicon-floppy-save pvcloud-device-edit" style="color:green" data-ng-click="EditDevice_Save(device)"  title="Guardar Cambios"></i>&nbsp;
                        <i class="glyphicon glyphicon-floppy-remove pvcloud-device-edit" style="color:red" data-ng-click="EditDevice_Delete(device)" title="Eliminar Dispositivo"></i>
                    </div>
                </div>
                <span data-ng-show="!device.deviceBeingEdited">{{device.device_nickname}}</span>
                <span data-ng-show="!device.deviceBeingEdited" class="badge success" title="Data records in pvCloud">{{device.device_id + 8}}</span>
                <br data-ng-show="!device.deviceBeingEdited">
                <small data-ng-show="!device.deviceBeingEdited" class="col-sm-12 text-muted" style="color:gray; margin:0; padding:0">{{device.device_description}}</small>

                <div data-ng-show="device.deviceBeingEdited">
                    <table style="width:60%" class="pvcloud-device-edit-form">
                        <tr>
                            <td style="text-align: right">Nombre:</td>
                            <td><input type="text" data-ng-model="device.device_nickname_edited" style="width:100%" /></td>
                        </tr>
                        <tr>
                            <td style="text-align: right">Descripción:</td>
                            <td>
                                <textarea data-ng-model="device.device_description_edited" style="width:100%" rows="2"></textarea>

                        </tr>
                        <tr>
                            <td style="text-align: right">API KEY:</td>
                            <td><code>{{device.api_key_edited}}</code></td>
                        </tr>                        
                    </table>

                </div>

            </td>
            <td data-ng-show="!device.deviceBeingEdited" class="td-device-info" style="text-align: center">
                <code>{{device.api_key}}</code> 
            </td>
            <td data-ng-show="!device.deviceBeingEdited" class="td-device-info" style="font-size: 2em">
                <i class="glyphicon glyphicon-pencil pvcloud-device-edit" data-ng-click="EditDevice(device)" data-ng-show="!device.deviceBeingEdited" title="Editar dispositivo."></i>
                <i class="glyphicon glyphicon-eye-open pvcloud-device-edit" title="Ver referencia del API" data-ng-click="ViewAPIReference(device)"></i>
            </td>
        </tr>
    </table>
    <div data-ng-if="!Devices || Devices.length === 0">You have no devices registered</div>
    <!--API DOCUMENTATION-->
    <div style="text-align: justify; font-size:16px" data-ng-show="SelectedDevice !== undefined">
        <hr>
        <i class="glyphicon glyphicon-remove pull-right pvcloud-device-edit" data-ng-click="CloseAPIReference();"></i>
        <h3>Documentación de la Interfase de Programación VSE</h3>
        <p class="bg-success" style="padding:10px;">
            En esta sección se describen las funciones disponibles del VSE API para el dispositivo seleccionado. Todos los ejemplos están previamente configurados con la informacion de cuenta, dispositivo y api_key para el dispositivo seleccionado por lo que se pueden utilizar de manera directa los enlaces en el dispositivo. <br><br>
            <strong>Dispositivo:</strong> <span style="font-family: monospace">{{SelectedDevice.device_nickname}} ({{SelectedDevice.device_id}})</span><br>
            <strong>API KEY:</strong> <span style="font-family: monospace">{{SelectedDevice.api_key}}</span><br><br>
            Si usted tiene un dispositivo Intel o copatible con NodeJS y Linux, puede descargar el kit del VSE API <strong> para su dispositivo </strong>en el siguiente comando wget: <br>

            <code style="text-align: left; display: inline-block">wget {{URLBegin}}/pvcloud_backend/<strong>nodejs_vse_api.php</strong>?account_id={{SelectedAccountID}}
                &device_id={{SelectedDevice.device_id}}<br>
                &api_key={{SelectedDevice.api_key}} pvcloud_vse_api.js</code>            
        </p>
        <p>VSE son las siglas de <strong>Valor Simple Extendible</strong>; y es la funcionalidad que le da a pvCloud su poder a través de la simplicidad.</p>
        <p>El API VSE consiste en una serie de CUATRO servicios en la nube que permiten a sus dispositivos enviar y consumir datos hacia y desde pvCloud.</p>
        <p>Las funciones que se suministran son:</p>
        <hr>
        <h3>#1 - Agregar Valor <small>(vse_add_value.php)</small></h3>
        <p>Es una forma sencilla de enviar valores de un dispositivo IoT a pvCloud. El sistema recibe los siguientes parámetros:</p>
        <ul>
            <li><strong>account_id: </strong> es el identificador numérico asignado a su cuenta de usuario de pvCloud.</li>
            <li><strong>device_id: </strong> es el identificador numérico asignado al dispositivo desde el cual usted está enviando los datos.</li>
            <li><strong>api_key: </strong> es el código de autenticación asignado a su dispositivo. Este puede ser cambiado en las pantallas de administración</li>
            <li><strong>label: </strong> este parámetro permite darle un nombre al dato que se está enviando. Por ejemplo "Sensor de Humedad"</li>
            <li><strong>type: </strong> es un parámetro que acepta cualquier texto, pero que tiene como objetivo determinar el tipo de dato que se está almacenando para tomarlo en cuenta al momento de consumir los datos.</li>
            <li><strong>value: </strong> corresponde al valor en sí que se desea almacenar. Nótese que soporta valores alfanuméricos e incluso descriptores JSON.</li>
            <li><strong>captured_datetime: </strong> la fecha y hora en que el dato fue capurado por el dispositivo. Este es un parámetro requerido.</li>
            <li><strong>annotations (opcional): </strong> es un parámetro para anotaciones adicionales</li>
        </ul>
        <h4>Ejemplo:</h4>
        <a href="{{URLBegin}}/pvcloud_backend/vse_add_value.php?account_id=1&device_id={{SelectedDevice.device_id}}&api_key={{SelectedDevice.api_key}}&label=DIRECT+pvCloud+TEST&value=12345&type=NUNMERICO&captured_datetime={{SelectedDevice.CapturedDatetime}}" target="_blank">
            <code>{{URLBegin}}/pvcloud_backend/<strong>vse_add_value.php</strong>?account_id={{SelectedAccountID}}
                &device_id={{SelectedDevice.device_id}}<br>
                &api_key={{SelectedDevice.api_key}}<br>
                &label=DIRECT+pvCloud+TEST<br>
                &value=12345<br>
                &type=NUMERICO<br>
                &captured_datetime={{SelectedDevice.CapturedDatetime}}</code>
        </a>
        <hr>
        <h3>#2 - Obtener el último valor <small>(vse_get_value_last.php)</small></h3>
        <p>Este método obtiene del servidor el último valor registrado para un dispositivo dado, ya sea para un "label" específico; o el último valor de todos los registrados para el dispositivo.</p>
        <p>Parámetros:</p>
        <ul>
            <li><strong>account_id: </strong> es el identificador numérico asignado a su cuenta de usuario de pvCloud.</li>
            <li><strong>device_id: </strong> es el identificador numérico asignado al dispositivo desde el cual usted está enviando los datos.</li>
            <li><strong>api_key: </strong> es el código de autenticación asignado a su dispositivo. Este puede ser cambiado en las pantallas de administración</li>
            <li><strong>optional_label: </strong> este parámetro permite solicitar al sistema el ultimo valor de una etiqueta específica. Si se omite, el sistem devolverá el último valor de todos para el dispositivo en cuestión.</li>
        </ul>        
        <h4>Ejemplos:</h4>
        <a href="{{URLBegin}}/pvcloud_backend/vse_get_value_last.php?account_id={{SelectedAccountID}}&device_id={{SelectedDevice.device_id}}&api_key={{SelectedDevice.api_key}}&optional_label=DIRECT+pvCloud+TEST" target="_blank">
            <code>{{URLBegin}}/pvcloud_backend/vse_get_value_last.php?account_id={{SelectedAccountID}}<br>
                &device_id={{SelectedDevice.device_id}}<br>
                &api_key={{SelectedDevice.api_key}}<br>
                &optional_label=DIRECT+pvCloud+TEST</code>  
        </a><br><br>
        <p>Sin el parámetro opcional sería así:</p>
        <a href="{{URLBegin}}/pvcloud_backend/vse_get_value_last.php?account_id={{SelectedAccountID}}&device_id={{SelectedDevice.device_id}}&api_key={{SelectedDevice.api_key}}" target="_blank">
            <code>{{URLBegin}}/pvcloud_backend/vse_get_value_last.php?account_id={{SelectedAccountID}}<br>
                &device_id={{SelectedDevice.device_id}}<br>
                &api_key={{SelectedDevice.api_key}}</code>  
        </a>     
        <hr>
        <h3>#3 - Obtener lista de valores registrados <small>vse_get_values.php</small></h3>
        <p>Este método devuelve una lista de todos los valores registrados, ya sea para una etiqueta de valor (optional_label) o todos los datos en general registrados por el dispositivo si se omite el parámetro de "optional_label".</p>
        <p>Parámetros:</p>
        <ul>
            <li><strong>account_id: </strong> es el identificador numérico asignado a su cuenta de usuario de pvCloud.</li>
            <li><strong>device_id: </strong> es el identificador numérico asignado al dispositivo desde el cual usted está enviando los datos.</li>
            <li><strong>api_key: </strong> es el código de autenticación asignado a su dispositivo. Este puede ser cambiado en las pantallas de administración</li>
            <li><strong>optional_label: </strong> este parámetro permite solicitar al sistema el ultimo valor de una etiqueta específica. Si se omite, el sistem devolverá el último valor de todos para el dispositivo en cuestión.</li>
            <li><strong>optional_last_limit: </strong> este parámetro permite solicitar al sistema una cantidad determinada de registros a partir de los más recientes.</li>
        </ul>        
        <h4>Ejemplos:</h4>
        <a href="{{URLBegin}}/pvcloud_backend/vse_get_values.php?account_id={{SelectedAccountID}}&device_id={{SelectedDevice.device_id}}&api_key={{SelectedDevice.api_key}}&optional_label=DIRECT+pvCloud+TEST&optional_last_limit=3" target="_blank">
            <code>{{URLBegin}}/pvcloud_backend/vse_get_values.php?account_id={{SelectedAccountID}}<br>
                &device_id={{SelectedDevice.device_id}}<br>
                &api_key={{SelectedDevice.api_key}}<br>
                &optional_label=DIRECT+pvCloud+TEST<br>
                &optional_last_limit=3
            </code>  
        </a><br><br>
        <p>Sin el parámetro opcional sería así:</p>
        <a href="{{URLBegin}}/pvcloud_backend/vse_get_values.php?account_id={{SelectedAccountID}}&device_id={{SelectedDevice.device_id}}&api_key={{SelectedDevice.api_key}}" target="_blank">
            <code>{{URLBegin}}/pvcloud_backend/vse_get_values.php?account_id={{SelectedAccountID}}<br>
                &device_id={{SelectedDevice.device_id}}<br>
                &api_key={{SelectedDevice.api_key}}</code>  
        </a>     
        <hr>        
        <h3>#4 - Limpiar/Borrar Valores Registrados <small>vse_clear_values</small></h3>
        <p>Este método realiza un borrado permanente de los valores registrados para un dispositivo específico, ya sea para una etiqueta de valor (optional_label) específica, o la eliminación de todos los valores almacenados por el dispositivo.</p>
        <p>Parámetros:</p>
        <ul>
            <li><strong>account_id: </strong> es el identificador numérico asignado a su cuenta de usuario de pvCloud.</li>
            <li><strong>device_id: </strong> es el identificador numérico asignado al dispositivo desde el cual usted está enviando los datos.</li>
            <li><strong>api_key: </strong> es el código de autenticación asignado a su dispositivo. Este puede ser cambiado en las pantallas de administración</li>
            <li><strong>optional_label: </strong> este parámetro permite solicitar al sistema borrar los valores con una etiqueta específica. Si se omite, el sistem borrarán todos los valores para el dispositivo en cuestión.</li>
        </ul>        
        <h4>Ejemplos:</h4>
        <a href="{{URLBegin}}/pvcloud_backend/vse_clear_values.php?account_id={{SelectedAccountID}}&device_id={{SelectedDevice.device_id}}&api_key={{SelectedDevice.api_key}}&optional_label=DIRECT+pvCloud+TEST" target="_blank">
            <code>{{URLBegin}}/pvcloud_backend/vse_clear_values.php?account_id={{SelectedAccountID}}<br>
                &device_id={{SelectedDevice.device_id}}<br>
                &api_key={{SelectedDevice.api_key}}<br>
                &optional_label=DIRECT+pvCloud+TEST</code>  
        </a><br><br>
        <p>Sin el parámetro opcional sería así:</p>
        <p class="bg-warning" role="alert" style="padding:10px"> (!) Nota: El siguiente ejemplo no contiene enlaces reales por que al acceder al enlace se eliminarían todos los datos del dispositivo</p>        
        <a href="" target="_blank">
            <code>{{URLBegin}}/pvcloud_backend/vse_clear_values.php?account_id={{SelectedAccountID}}<br>
                &device_id={{SelectedDevice.device_id}}<br>
                &api_key={{SelectedDevice.api_key}}</code>  
        </a>          
    </div>
</div>